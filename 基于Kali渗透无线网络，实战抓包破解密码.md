 最近看了几年前的无线网络加密方式与利用Kali可以实现抓包，并破解Wi-Fi密码的几款优秀工具讲解的几篇文章，内容差不多跟刚学无线网络安全和渗透测试的时候参考的文档内容相同，今天写此文章浅谈一下无线网络抓包方式破解无线网络密码和分析获取用户信息的过程和防范。



注意：此文涉及的内容具有一定的风险，只用参考和技术研究，切勿用于破坏公共场所网络或非法目的！



注意：此文涉及的内容具有一定的风险，只用参考和技术研究，切勿用于破坏公共场所网络或非法目的！



注意：此文涉及的内容具有一定的风险，只用参考和技术研究，切勿用于破坏公共场所网络或非法目的！



重要事情说三遍，重要事情说三遍，重要事情说三遍 !!!



0X01
Wi-Fi加密方式


一般来说，Wi-Fi有以下几种加密方式：

WEP（有线等效加密）——采用WEP 64位或者128位数据加密。

WPA-PSK [TKIP]——采用预共享密钥的Wi-Fi保护访问，采用WPA-PSK标准加密技术，加密类型为TKIP。

WPA2-PSK [AES]——采用预共享密钥的Wi-Fi保护访问（版本2），采用WPA2-PSK标准加密技术，加密类型为AES。

WPA-PSK [TKIP] + WPA2-PSK [AES]——允许客户端使用WPA-PSK [TKIP]或者WPA2-PSK [AES]。

WAPI——即无线局域网鉴别与保密基础结构，中国支持的加密技术，在行货手机上内置，目前无线运营商的wi-fi网络设备已经支持这种加密技术，但没有开始推广使用。



在我们周围最常见的加密方式有 WPA/WPA2 PSK，而使用范围比较广泛（电脑和手机等设备发起热点也是采用这种加密方式）。



0X02
前期准备


在Kali环境下抓包需要利用aircrack-ng工具来实现，而且重要的是想要用aircrack-ng来实现抓包和破解，网卡必须支持监听模式，所以需要选择支持监听模式的无线网卡来实验，建议选择网卡芯片为rt5572,rt8187或rtl8812aul的。



0X03
开始抓包


第一步: 打开一个终端，用 iwconfig 命令来查看本机的无线网卡



iwconfig
这里检测出来的无线网卡名称为 wlan0,（因网卡的芯片和系统版本原因名称不一样）。



图片

////////////////////////////////////////////////////////////////////////////

第二步：用 airmon-ng start wlan0 命令开启网卡的监听模式,(wlan0为 网卡名称)



airmon-ng start wlan0


图片



注意: 输入完以后重新查看本机网卡，发现检测出来的网卡名称是wlan0mon，而不是刚才的wlan0则表示开启监听模式成功!

////////////////////////////////////////////////////////////////////////////////////////////

第三步：用 airodump-ng wlan0mon 命令扫描附件的 wi-fi



airodump-ng wlan0mon


图片



输入命令之后系统开始扫描附件的Wi-Fi，并且还在不断增加，有很详细的WIFI信息，包括信道、MAC、信号强度等等。其中CH代表信道，BSSID是目标的mac地址!(若想终止扫描则按ctrl+c停止!)

////////////////////////////////////////////////////////////////////////////////////////////

第四步：用 airodump-ng wlan0mon -c 目标网络信道 --bssid 指定的目标MAC地址 -w 抓包文件保存目录 (这里对无线网络vm888 进行抓包)



airodump-ng wlan0mon -c 4 1C:60:DE:9D:6F:A6 -w hack wlan0mon


图片



0X04
进攻网络


现在系统对目标网络开始进行抓包，下面说一下关于抓包破解的一些需求:

对于抓包指的是对方正在使用WIFI并和路由器不断交换数据，要是没有人使用，一直空闲的话是没办法抓到包的，还有就是用户在使用过程中抓不到包就需要对该WIFI进行攻击(最常见的是deauth攻击)，让用户被迫掉线并用户重新连接该网络，因此而获取用户连接该网络时利用的秘钥(密码)。

这里我们利用aireplay-ng的工具，它可以强制用户断开wifi连接；原理是，给连接到wifi的一个设备发送一个deauth（解除认证攻击）包，让那个设备断开wifi，随后它自然会再次连接wifi，aireplay-ng的生效前提是，wifi网络中至少有一个连接的设备。

以下为airepaly-ng的一些攻击原理:

aireplay-ng当前支持的攻击种类如下：

Attack 0：解除认证攻击

Attack 1：伪造认证攻击

Attack 2：交互式注入攻击

Attack 3：ARP请求包重放攻击

Attack 4：chopchop Korek攻击

Attack 5：碎片交错攻击

Attack 6：Cafe-latte 攻击

Attack 7：面向客户的碎片攻击

Attack 8：WPA迁移模式

Attack 9：数据包注入测试


////////////////////////////////////////////////////////////////////////////////////////////

第五步：新建一个终端(注意新建终端，不许停止或关闭当前进行抓包的终端)，用 aireplay-ng -0 攻击次数 -a 指定无线路由器BSSID -c 已连接该无线网的合法客户BSSID (-0代表解除认证攻击,也就是deauth攻击)命令来发起deauth攻击。

这里主要说明的是 aireplay-ng -0 10 –a<ap mac> -c <mymac> wifi0 参数说明：

-0：冲突攻击模式，后面跟发送次数（设置为0，则为循环攻击，不停的断开连接，客户端无法正常上网）

-a：设置 ap 的 mac

-c：设置已连接的合法客户端的 mac。

如果不设置-c，则断开所有和 ap 连接的合法客户端。

aireplay-ng -3 -b <apmac> -h <my mac>wifi0

注：使用此攻击模式的前提是必须有通过认证的合法的客户端连接到路由器

这里我们对已经连接目标网络(vm888)的合法用户(可以连接该网络的设备) 进行deauth攻击(解除认证攻击):



airepaly-ng -0 10 -a 1C:60:DE:9D:6F:A6 -c 48:8A:D2:28:3A:A0 wlan0mon


图片



以上照片来看，目标网络已连接的客户有两个合法用户，我们对其中的一个用户进行deauth攻击，并让他重新连接该网络。

////////////////////////////////////////////////////////////////////////////////////////////



0X05
结束抓包


第六步:发起deauth攻击以后，返回当前的抓包终端并按Ctrl + C结束抓包。



图片



////////////////////////////////////////////////////////////////////////////////////////////





0X06
破解密码


第七步:用aircrack-ng -a2 -b 1C:60:DE:9D:6F:A6 -w pass.txt hack-08.cap 命令来进行密码破解

参数解释：

-a2代表WPA的握手包

-b指定要破解的wifi BSSID (也就是刚才我们进行抓包的目标网络(vm888)的BSSID)。

-w指定字典文件 (这里用的是pass.txt)

最后是已破解完的包名。(hack-08.cap)



图片

大告成功! 以上结果来看，对目标包进行破解需要时间不到1秒就成功破解了密码，每秒平均用了66.68个密码进行对比(66.68k/s)，破解出来的密码是18871208。

////////////////////////////////////////////////////////////////////////////////////////////



0X07
结果分析


这里可以说明的是破解速度相关与自己电脑的配置有关，当然这里可能还有人问这个破解出来的密码很简单，复杂的也有用吗?，答案是可以的，可是提前说明的是这个破解原理来讲，最终的破解过程还是依赖密码字典，如果你的密码字典够强，没有你破解不到的密码，KALI LINUX里面也默认提供一些密码字典，可是地区和用词习惯而破解效果不一样，也就是默认字典破解不出来，比如说:开发商提供的默认字典密码肯定用英文词来组成的，比如 Alex199502，Alexander等等人名+数字或别的词语，可是到我们这边就不一定，比如chenglei123，wodewangluo等等。

我以前查找一些相关资料来知道了很多密码破解的方法，比如分布式破解，制作哈希表(HashTable)等破解方法来提供破解速度和成功率，一个够强的哈希表来破解可以把破解速度提升到700000k/s(设备也够强条件下)，也可以用GPU（显卡）的性能来破解同样可以提升破解速度。有趣的可以自行百度，也有一些网站提供密码字典和这样的哈希表，可是有些大小甚至超过300GB，可是KALI LINUX和WINDOWS环境下也有制作哈希表的工具，我们以后再讲。

最后讲的是我们抓的数据包内容包含用户的一些敏感信息，比如论坛账号及密码，邮箱账号密码及邮箱内容，用户登录或访问的网站及提交的敏感参数，这里就不能再详细解释了，有趣自行去百度，本文章仅提供技术研究，切勿用非法目的!!
